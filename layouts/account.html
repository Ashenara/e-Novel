{{ define "main" }}
<div class="container mx-auto px-4 py-12">

    <div class="flex justify-between items-center mb-8">
        <h1 class="text-3xl font-bold">{{ .Title }}</h1>
        <div class="flex items-center space-x-2">
            {{/* --- NEW: Edit Profile Button --- */}}
            <button id="edit-profile-btn" class="bg-(--color-primary) text-white px-4 py-2 rounded-lg font-semibold hover:bg-(--color-primary-hover) transition-colors shadow-md">
                Edit Profile
            </button>
            <button id="logout-btn" class="bg-red-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-red-700 transition-colors shadow-md">
                Logout
            </button>
        </div>
    </div>

    <div id="account-content">
        <p id="loading-state" class="text-(--color-muted-foreground)">Loading your account details...</p>

        <!-- Library Section -->
        <section id="library-section" class="mb-12 hidden">
            <h2 class="text-2xl font-bold text-(--color-foreground) mb-4 border-b border-(--color-border) pb-2">My Library</h2>
            <div id="library-grid" class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-4">
                <!-- Novel cards will be injected here -->
            </div>
            <p id="library-empty" class="text-center py-8 bg-(--color-muted) rounded-lg hidden">You haven't added any novels to your library yet.</p>
            
            {{/* --- NEW: Library Pagination Controls --- */}}
            <div id="library-pagination" class="flex justify-center items-center mt-6 space-x-4 hidden">
                <button id="library-prev-btn" class="px-4 py-2 bg-(--color-muted) rounded-lg hover:bg-opacity-80 disabled:opacity-50 disabled:cursor-not-allowed">Previous</button>
                <span id="library-page-info" class="font-semibold text-(--color-muted-foreground)"></span>
                <button id="library-next-btn" class="px-4 py-2 bg-(--color-muted) rounded-lg hover:bg-opacity-80 disabled:opacity-50 disabled:cursor-not-allowed">Next</button>
            </div>
        </section>

        <!-- History Section -->
        <section id="history-section" class="hidden">
            <h2 class="text-2xl font-bold text-(--color-foreground) mb-4 border-b border-(--color-border) pb-2">Reading History</h2>
            <div id="history-list" class="space-y-2">
                 <!-- History items will be injected here -->
            </div>
            <p id="history-empty" class="text-center py-8 bg-(--color-muted) rounded-lg hidden">You haven't read any novels yet.</p>
            
            {{/* --- NEW: History Pagination Controls --- */}}
            <div id="history-pagination" class="flex justify-center items-center mt-6 space-x-4 hidden">
                <button id="history-prev-btn" class="px-4 py-2 bg-(--color-muted) rounded-lg hover:bg-opacity-80 disabled:opacity-50 disabled:cursor-not-allowed">Previous</button>
                <span id="history-page-info" class="font-semibold text-(--color-muted-foreground)"></span>
                <button id="history-next-btn" class="px-4 py-2 bg-(--color-muted) rounded-lg hover:bg-opacity-80 disabled:opacity-50 disabled:cursor-not-allowed">Next</button>
            </div>
        </section>
    </div>

    <div id="edit-profile-modal" class="fixed inset-0 z-50 bg-black/50 backdrop-blur-sm hidden flex items-center justify-center p-4">
    <div class="bg-(--color-card) w-full max-w-md p-6 rounded-lg shadow-xl relative">
        <!-- Close Button -->
        <button id="close-modal-btn" class="absolute top-3 right-3 p-1 text-(--color-muted-foreground) hover:text-(--color-foreground)">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>

        <h3 class="text-2xl font-bold mb-4 text-(--color-foreground)">Edit Your Profile</h3>
        
        <form id="profile-form">
            <div class="space-y-4">
                <div>
                    <label for="display-name-input" class="block text-sm font-medium text-(--color-muted-foreground) mb-1">Display Name</label>
                    <input type="text" id="display-name-input" class="w-full px-3 py-2 bg-(--color-background) border border-(--color-border) rounded-md focus:outline-none focus:ring-2 focus:ring-(--color-primary)">
                </div>
                <div>
                    <label for="avatar-url-input" class="block text-sm font-medium text-(--color-muted-foreground) mb-1">Avatar Image URL</label>
                    <input type="url" id="avatar-url-input" class="w-full px-3 py-2 bg-(--color-background) border border-(--color-border) rounded-md focus:outline-none focus:ring-2 focus:ring-(--color-primary)" placeholder="https://...">
                </div>
            </div>
            <div class="mt-6 flex justify-end items-center space-x-4">
                <p id="profile-status-msg" class="text-sm text-(--color-muted-foreground)"></p>
                <button id="profile-save-btn" type="submit" class="px-6 py-2 bg-(--color-primary) text-white font-semibold rounded-lg hover:bg-(--color-primary-hover) disabled:opacity-50">
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>

{{ end }}