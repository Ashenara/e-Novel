{{ $ctx := . }}

{{ $imageSrc := "" }}
{{ with $ctx.Params.image }}
    {{ $imageSrc = . | relURL }}
{{ else }}
    {{ $imageSrc = "https://placehold.co/400x600/27272A/FFFFFF?text=Cover" }}
{{ end }}

{{ $title := $ctx.Title }}
{{ $permalink := $ctx.Permalink }}
{{ $genres := $ctx.Params.genres | default (slice) }}
{{ $status := $ctx.Params.status | default "" }}
{{ if reflect.IsSlice $status }}{{ with first 1 $status }}{{ $status = index . 0 }}{{ end }}{{ end }}

<a href="{{ $permalink }}" class="group block w-full rounded-lg shadow-md overflow-hidden relative transition-transform duration-300 hover:shadow-xl hover:-translate-y-1 aspect-2/3">
    
    <!-- Image -->
    <img loading="lazy" 
         src="{{ $imageSrc }}"
         alt="{{ $title }} Cover"
         class="absolute inset-0 w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"
         onerror="this.onerror=null;this.src='https://placehold.co/400x600/CCCCCC/666666?text=Image+Missing';">

    <!-- Gradient Overlay for Text Readability -->
    <div class="absolute inset-0 bg-linear-to-t from-black/60 via-black/20 to-transparent"></div>

    <!-- Status Badge (REVAMPED) -->
    {{ with $status }}
    <!-- Changed position from top-2 right-2 to top-2 left-2 -->
    <div class="absolute top-2 left-2 z-10">
        <!-- Changed background to be semi-transparent black for a more integrated look -->
        <span class="bg-black/70 text-white text-[10px] font-semibold px-2 py-0.5 rounded-full shadow">
            {{ . }}
        </span>
    </div>
    {{ end }}
    
    <!-- Content positioned at the bottom -->
    <div class="absolute bottom-0 left-0 right-0 p-3 text-white">
        <!-- Title -->
        <h3 class="font-bold text-sm leading-tight line-clamp-2 mb-1 group-hover:underline" style="text-shadow: 1px 1px 3px rgb(0 0 0 / 0.7);">
            {{ $title }}
        </h3>
        
        <!-- Single Genre -->
        {{ with first 1 $genres }}
        <span class="text-xs text-white/80 font-medium line-clamp-1">
            {{ index . 0 }}
        </span>
        {{ end }}
    </div>
</a>